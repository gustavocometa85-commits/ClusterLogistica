{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Clúster Logística | Calendario</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />

    <style>
        body { background-color: #f0f2f5; font-family: sans-serif; }
        .navbar-custom { background-color: #212529; color: white; }

        /* Ajustes del Calendario */
        #calendar {
            background-color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            min-height: 700px;
        }
        .fc-toolbar-title { font-size: 1.5rem !important; font-weight: bold; text-transform: capitalize; }
        .fc-event { cursor: pointer; border: none; font-size: 0.85rem; padding: 2px 4px; }
        .fc-day-today { background-color: #e8f4ff !important; }
    </style>
</head>
<body>

    <nav class="navbar navbar-custom shadow-sm mb-4">
        <div class="container-fluid px-4 py-2">
            <a href="{% url 'dashboard' %}" class="navbar-brand mb-0 h1 fw-bold text-decoration-none text-white">
                <i class="bi bi-arrow-left-circle me-2"></i>Volver al Dashboard
            </a>
        </div>
    </nav>

    <div class="container pb-5">
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3 class="fw-bold text-dark"><i class="bi bi-calendar-week me-2"></i>Programación de Viajes</h3>

                    <div>
                        <span class="badge bg-primary me-1">En Ruta</span>
                        <span class="badge bg-warning text-dark me-1">Programado</span>
                        <span class="badge bg-success">Completado</span>
                    </div>
                </div>

                <div id='calendar'></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/es.js'></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');

            // Recibimos los datos de Django
            var eventos = JSON.parse('{{ eventos_json|escapejs }}');

            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                locale: 'es', // Idioma español
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,listMonth'
                },
                events: eventos,

                // Al pasar el mouse por encima (Tooltip simple)
                eventDidMount: function(info) {
                    var tooltip = new bootstrap.Tooltip(info.el, {
                        title: info.event.extendedProps.chofer + " | " + info.event.extendedProps.vehiculo + " | " + info.event.extendedProps.ingreso,
                        placement: 'top',
                        trigger: 'hover',
                        container: 'body'
                    });
                },

                // Al hacer clic
                eventClick: function(info) {
                    // Si hay URL, deja que navegue
                    if (info.event.url) {
                        return;
                    }
                }
            });
            calendar.render();
        });
    </script>
</body>
</html>